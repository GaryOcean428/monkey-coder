{
  "$schema": "https://schema.railpack.com",
  "provider": "python",
  "packages": {
    "node": "22",
    "python": "3.13"
  },
  "caches": {
    "yarn": {
      "directory": "/root/.yarn",
      "type": "shared"
    }
  },
  "steps": {
    "node-install": {
      "commands": [
        { "cmd": "node -v && npm -v" },
        { "cmd": "corepack prepare yarn@4.9.2 --activate" },
        { "cmd": "yarn -v || corepack yarn -v" },
        { "cmd": "yarn install" }
      ],
      "caches": ["yarn"]
    },
    "node-build": {
      "inputs": [
        { "step": "node-install" }
      ],
      "commands": [
        { "cmd": "cd packages/web && yarn build" }
      ],
      "deployOutputs": [
        "packages/web/out/**"
      ]
    }
  },
  "deploy": {
    "startCommand": "python run_server.py",
    "inputs": [
      "...",
      { "step": "node-build", "include": ["packages/web/out/**"] }
    ]
  }
}
