{
  "version": "1",
  "packages": {
    "python": "3.12.11",
    "node": "22.11.0",
    "yarn": "4.9.2"
  },
  "install": [
    { "command": "python -m venv /app/.venv", "cache": "/app/.venv" },
    { "command": "source /app/.venv/bin/activate && pip install -r requirements.txt", "dependsOn": ["requirements.txt", "pyproject.toml"] },
    { "command": "corepack enable && corepack prepare yarn@4.9.2 --activate", "description": "Enable Yarn 4" },
    { "command": "yarn install", "dependsOn": ["package.json", "yarn.lock"], "cache": "node_modules" },
    { "command": "yarn workspace @monkey-coder/web build", "dependsOn": ["packages/web/"], "output": "packages/web/out" }
  ],
  "deploy": {
    "command": "/app/.venv/bin/python /app/run_server.py",
    "healthcheck": { "path": "/health", "interval": "30s", "timeout": "5s" }
  },
  "environment": {
    "NODE_ENV": "production",
    "PYTHON_ENV": "production"
  }
}